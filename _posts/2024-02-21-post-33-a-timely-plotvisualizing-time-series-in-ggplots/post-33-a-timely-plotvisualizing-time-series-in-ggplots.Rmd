---
title: 'Post #33. A "timely" plotâ€”Visualizing time series data in ggplots'
description: |
  Create awesome time series line charts in ggplots.
author:
  - name: Gen-Chang Hsu
date: 2024-02-21
output:
  distill::distill_article:
    self_contained: false
categories:
  - "2024"
preview: ../../homepage_images/Post33.png
draft: true
---

<!-- Webpage style -->

<style>
d-article a {
  color: #2780e3 !important;
  border-bottom: none !important;
}

d-article a:hover {
  color: #2780e3 !important;
  border-bottom: 2px solid !important;
}

d-byline {
  margin-left: -10% !important;
}

d-title {
  margin-left: -10%;
}

d-title h1{
  font-size: 45px;
  width: 130%;
}

d-article {
  margin-left: -10%;
}

p {
  width: 120%;
}

d-article h2 {
  width: 120%;
}

d-article h3 {
  width: 120%;
  font-size: 28px;
}

div.article-footer{
  width: 120%;
}

d-article div.sourceCode { 
  width: 120% !important;
}

d-article pre { 
  width: 120% !important;
}

div.l-body {
  width: 120% !important;
}

d-article table thead tr {
  height: 60px !important;
  width: 210px !important;
}

d-article table thead th {
  height: 60px !important;
  font-size: 22px !important;
  width: 210px !important;
}

d-article table tbody tr td {
  font-size: 21px !important;
  height: 60px !important;
  text-align: center !important;
  width: 210px !important;
}

div.l-body img {
    margin-right: 30% !important;
}

</style>

<head>
  <base target="_blank">
</head>

```{r setup, include = FALSE}
knitr::opts_chunk$set(message = F, 
                      error = F, 
                      warning = F,
                      fig.align = "center")

```

<!-- Start of the article -->

## Introduction

Welcome to the first post of 2024! It's been a while since my last post last year (to be precise two months; maybe it's not really long?), and I feel excited to be back in the saddle and write something about ggplots. Hope we'll have another year of posts full of useful and fun topics! 

To kick things off, I'll be showing you how to create time series plots in ggplots. Time series plots are essentially a type of line charts with "time" on the x-axis. Of course, you can simply treat time as a numeric variable and plot it as a usual line chart, but ggplot does offer a set of functions that work directly with time. So in this post, we're going to explore these functions and see how we can leverage them to create a nice time series plot! 


## The data

In most previous posts, I used built-in R datasets as examples. But this time it's a bit different: I'll be using the data I collected myself! 

I've been recording the number of [black kites (_Milvus migrans_)](https://ebird.org/species/blakit1) along the Xindian river in Taipei, Taiwan from November 2022 to August 2023 (pretty much every day except for a few times when I was out of town), and this dataset consists of the daily black kite counts, the locations of the observations, and the weather conditions.

Let's take a quick look at the dataset:

```{r, fig.width = 5, fig.height = 4}
library(tidyverse)
library(readxl)

### Read the data
black_kite_raw <- read_xlsx("Black_Kite_Records.xlsx", sheet = 1)

### Organize the data
black_kite_clean <- black_kite_raw %>% 
  mutate(Date = ymd(Date)) %>% 
  select(Date, Site, Number, Weather)

head(black_kite_clean)

```
The majority of the observations came from one site "Huajiang Bridge", so we'll just focus on this particular site from now on. Below is a site map created via [ggmap](https://cran.r-project.org/web/packages/ggmap/readme/README.html):

```{r, fig.width = 5, fig.height = 4, out.width = "60%", fig.align = 'right'}
library(ggmap)

### Need to register an API key for Stadia Maps and for Google Maps
register_stadiamaps(key = "your key")
register_google(key = "your key")

register_stadiamaps(key = "69ccb61d-8886-4e2a-9ed1-fd5c67dab17b")
register_google(key = "AIzaSyBPa8CKmRUxaQEPRvy2C3comSZGp6AOyh8")

### Get the long-lat coordinates of the bridge
huajiang_bridge_lon_lat <- geocode("Huajiang Bridge, Wanhua District")

### Create a map
map_data <- get_stadiamap(bbox = c(left = huajiang_bridge_lon_lat$lon - 0.05, 
                                   bottom = huajiang_bridge_lon_lat$lat - 0.04, 
                                   right = huajiang_bridge_lon_lat$lon + 0.05, 
                                   top = huajiang_bridge_lon_lat$lat + 0.04), 
                          zoom = 14, 
                          maptype = "stamen_terrain")

ggmap(map_data) + 
  annotate(geom = "rect", 
           xmin = huajiang_bridge_lon_lat$lon - 0.01,
           ymin = huajiang_bridge_lon_lat$lat - 0.01,
           xmax = huajiang_bridge_lon_lat$lon + 0.01,
           ymax = huajiang_bridge_lon_lat$lat + 0.01,
           fill = NA,
           color = "red",
           linewidth = 1.5) + 
  theme_void()

```
<br>

## The time series plot

Break it down into various steps


```{r, fig.width = 5, fig.height = 4}
library(tidyverse)



```







## Summary



Hope you learn something useful from this post and don't forget to leave your comments and suggestions below if you have any!


