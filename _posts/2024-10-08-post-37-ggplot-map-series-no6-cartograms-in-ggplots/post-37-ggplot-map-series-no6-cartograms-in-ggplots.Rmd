---
title: "Post #37. ggplot Map Series No.6: Cartograms in ggplots"
description: |
  Come and learn how to create cartograms in ggplots!
author:
  - name: Gen-Chang Hsu
date: 2024-10-08
output:
  distill::distill_article:
    self_contained: false
categories:
  - "2024"
  - "Map Series"
preview: ../../homepage_images/Post37.png
---

<!-- Webpage style -->

<style>
d-article a {
  color: #2780e3 !important;
  border-bottom: none !important;
}

d-article a:hover {
  color: #2780e3 !important;
  border-bottom: 2px solid !important;
}

d-byline {
  margin-left: -10% !important;
}

d-title {
  margin-left: -10%;
}

d-title h1{
  font-size: 45px;
  width: 130%;
}

d-article {
  margin-left: -10%;
}

p {
  width: 120%;
}

d-article h2 {
  width: 120%;
}

d-article h3 {
  width: 120%;
  font-size: 28px;
}

div.article-footer{
  width: 120%;
}

d-article div.sourceCode { 
  width: 120% !important;
}

d-article pre { 
  width: 120% !important;
}

div.l-body {
  width: 120% !important;
}

d-article table thead tr {
  height: 60px !important;
  width: 210px !important;
}

d-article table thead th {
  height: 60px !important;
  font-size: 22px !important;
  width: 210px !important;
}

d-article table tbody tr td {
  font-size: 21px !important;
  height: 60px !important;
  text-align: center !important;
  width: 210px !important;
}

div.l-body img {
    margin-right: 30% !important;
}

</style>

<head>
  <base target="_blank">
</head>

```{r setup, include = FALSE}
knitr::opts_chunk$set(message = F, 
                      error = F, 
                      warning = F,
                      fig.align = "center")

```

<!-- Start of the article -->

## Introduction

In a [previous post](https://genchanghsu.github.io/ggGallery/posts/2023-03-09-post-25-ggplot-map-series-no1-basic-ggplot-maps/) in this Map Series, I wrote about how to create choropleth maps in ggplots: they are thematic maps that visualize the quantity of a focal variable across a geographical area (e.g., the population size of each country in the world) using different colors. Choropleth maps are easy to read and provide a quick glance at the spatial patterns of the focal variable.

Similar to choropleth maps, cartograms also visualize the quantity of a variable across a geographical area, but now the geographic size of the regions is altered to be proportional to the numerical values of the focal variable. This enhances the visual impacts of the maps. And in fact, it's easy to switch between a choropleth to a cartogram as they are both created from data with the same underlying structure!

In this post, I'll show you how to create cartograms in ggplots. We'll then make a variant of cartogram by adding pie charts to the map. Read on!


## A map of the world forest area

We're going to make a thematic map of the world forest area by country. The dataset can be downloaded from the website [Our World in Data](https://ourworldindata.org/forest-area): it contains the forest area in each country from 1990 to 2020.

First, let's create a choropleth map of the forest area in 2020. We retrieved the world base map from the [Natural Earth](https://www.naturalearthdata.com/) database using the package `rnaturalearth` and joined the forest data to the world map data to draw the choropleth map:

```{r, fig.width = 8, fig.height = 5, out.width = "90%"}
library(tidyverse)

### Read the forest area data
country_forest_area <- read_csv("Country_Forest_Area.csv")

country_forest_area_2020 <- country_forest_area %>% 
  filter(Year == 2020)

### Get a world base map from Natural Earth
library(rnaturalearth)

world_map <- ne_countries(type = "countries", returnclass = "sf", scale = 110)

### Join the forest data to the map data
world_map_forest_area_2020 <- world_map %>% 
  mutate(Code = toupper(adm0_a3)) %>% 
  left_join(country_forest_area_2020, by = join_by("adm0_a3" == "Code"))

### Create a choropleth map of the world forest area by country
library(sf)  # for the function "st_crs()"
library(ggtext)  # for the function "element_markdown()"
library(colorspace)  # for the function "scale_fill_continuous_sequential()"

ggplot(world_map_forest_area_2020) + 
  geom_sf(aes(fill = `Forest area`)) + 
  coord_sf(crs = st_crs("ESRI:54030")) +  # Robinson projection
  scale_fill_continuous_sequential(palette = "Greens",
                                   breaks = seq(1e8, 8e8, by = 2e8), 
                                   labels = str_glue("<span>{c(1, 3, 5, 7)}Ã—10^8^</span>"), 
                                   name = "<span>Forest area (km^2^)</span>") + 
  theme_bw() + 
  theme(panel.border = element_blank(),
        legend.title = element_markdown(hjust = 0.5),
        legend.text = element_markdown(),
        legend.direction = "horizontal",
        legend.position = "top",
        legend.title.position = "top")

```

Now we'll create a cartogram


```{r, fig.width = 7, fig.height = 4, out.width = "90%"}
# install.packages("cartogram")  # install the package if you haven't
library(cartogram)

ggplot(world_map_forest_area_2020) + 
  geom_sf(aes(fill = `Forest area`)) + 
  coord_sf(crs = st_crs("ESRI:54030")) +  # Robinson projection
  theme_bw()


```




## Summary


Hope you learn something useful from this post and don't forget to leave your comments and suggestions below if you have any!




