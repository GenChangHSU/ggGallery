---
title: "Post #24. The spark between gt and ggplot2: Visualizing the top ten bird-window collision species in Taiwan"
description: |
  An awesome integration of `gt` and `ggplot2` tells the story of the top ten bird-window collision species in Taiwan!
author:
  - name: Gen-Chang Hsu
date: 2023-02-18
output:
  distill::distill_article:
    self_contained: false
categories:
  - "2023"
preview: ../../homepage_images/Post24.png
draft: true
---

<!-- Webpage style -->

<style>
d-article a {
    color: #2780e3 !important;
      border-bottom: none !important;
}

d-article a:hover {
  color: #2780e3 !important;
    border-bottom: 2px solid !important;
}

d-byline {
  margin-left: -10% !important;
}

d-title {
  margin-left: -10%;
}

d-title h1{
  font-size: 45px;
  width: 130%;
}

d-article {
  margin-left: -10%;
}

p {
  width: 120%;
}

d-article h2 {
  width: 120%;
}

d-article h3 {
  width: 120%;
  font-size: 28px;
}

div.article-footer{
  width: 120%;
}

d-article div.sourceCode { 
  width: 120% !important;
}

d-article pre { 
  width: 120% !important;
}

div.l-body {
  width: 120% !important;
}

d-article table thead tr {
  height: 60px !important;
  width: 210px !important;
}

d-article table thead th {
  height: 60px !important;
  font-size: 22px !important;
  width: 210px !important;
}

d-article table tbody tr td {
  font-size: 21px !important;
  height: 60px !important;
  text-align: center !important;
  width: 210px !important;
}

div.l-body img {
    margin-right: 20% !important;
}

</style>


```{r setup, include = FALSE}
knitr::opts_chunk$set(message = F, 
                      error = F, 
                      warning = F,
                      fig.align = "center")

```

<!-- Start of the article -->

## Introduction

The [`ggplot2`](https://ggplot2.tidyverse.org/) package, one of the most popular packages in R, is a powerful tool for making elegant data visualizations based on the **g**rammar of **g**raphics. Recently, the [`gt`](https://gt.rstudio.com/) package, the ggplots for tables, came on the scene. Based on the **g**rammar of **t**ables, it makes creating tables in R much more convenient and versatile.

The main idea of `gt` is to build tables from a set of components such as the header, the stub, the column labels, the body, and the footer. We can compose each of these parts individually, customize their formats and styles, and finally put them together. `gt` is itself an amazing package for awesome table displays. But what's even more exciting is that it can be used in conjunction with ggplots, which will certainly enhance the effectiveness of data visualizations and I can't wait to try it out. 

To this end, I'll do a small data viz project in this post to visualize the top ten bird-window collision species in Taiwan. Bird-window collisions, quite literally, are birds colliding with windows of buildings or other human-made structures. Study ^[Loss, S. R., Will, T., & Marra, P. P. (2015). Direct mortality of birds from anthropogenic causes. *Annual Review of Ecology, Evolution, and Systematics*, 46, 99-120.] has shown that this is one of the leading anthropogenic bird mortality sources, killing hundreds of millions of birds each year.

At the end of the post, you'll find out what the top ten bird-window collision species in Taiwan are. Also, this post is not just a data viz practice; hopefully, it can help raise the awareness of this concerning wildlife issue and make the invisible visible. Finally, a shout-out to [Chi-Heng Hsieh](https://twitter.com/ginny_r10b44004), who kindly provided the bird-window collision data for this post!

## Let's build the table

Before we start off, I would like to give you an overall idea of what the table will look like: It has a first column showing the images of the bird species, a second column showing the species names along with a short description of each, a third column showing the total number of collision cases for each species between 2010 and 2022, and a fourth column showing the annual trends of the cases over this 13-year period.

In the following section, I'll break down the process into several steps so that it's easier to follow and understand what each step is doing.

### 1. Data preparation and summary

As always, the first step in a data project is to prepare the data. After reading in the data set, we count the total number of collision cases between 2010 and 2022, as well as the number of species recorded in this period. Because there are some cases where the colliding individuals were only identified to the genus or family level, we filter them out before tallying the unique species names.

```{r, fig.width = 6, fig.height = 4, out.width = "70%", fig.show = "hold"}
library(tidyverse)

### Read in the data set
bwc_data <- read_csv("BWC_data.csv")

### Total cases between 2010 and 2022
bwc_data %>% 
  filter(year >= 2010) %>% 
  nrow()

### Number of collision species
bwc_data %>% 
  filter(year >= 2010) %>%
  rowwise() %>% 
  filter(length(unlist(str_split(species, " "))) == 2) %>%  # remove the families
  filter(!str_detect(species, "sp\\.")) %>%  # remove the genera
  distinct(species) %>% 
  nrow()

```

### 2. The top ten collisiion species

Next, 

```{r, fig.width = 6, fig.height = 4, out.width = "70%", fig.show = "hold"}
library(tidyverse)




```




### 3. The images and short descriptions of the species


### 4. The header and footer


### 5. Put them together


### 6. Polish the table


### 7. The messages from the table




## Summary



Hope you learn something useful from this post and don't forget to leave your comments and suggestions below if you have any!





