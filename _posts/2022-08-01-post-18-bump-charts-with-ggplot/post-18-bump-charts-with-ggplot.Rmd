---
title: "Post #18. Bump charts with ggplot"
description: |
  Come and learn how to create nice bump charts with ggplot!
author:
  - name: Gen-Chang Hsu
date: 2022-08-01
output:
  distill::distill_article:
    self_contained: false
categories:
  - "2022"
preview: ../../homepage_images/Post18.png
---

<!-- Webpage style -->
<style>
d-article a {
    color: #2780e3 !important;
    border-bottom: none !important;
}

d-article a:hover {
    color: #2780e3 !important;
    border-bottom: 2px solid !important;
}

d-byline {
    margin-left: -10% !important;
}

d-title {
    margin-left: -10%;
}

d-title h1{
    font-size: 45px;
    width: 130%;
}

d-article {
    margin-left: -10%;
}

p {
    width: 120%;
}

d-article h2 {
    width: 120%;
}

d-article h3 {
  width: 120%;
  font-size: 28px;
}

div.article-footer{
    width: 120%;
}

d-article div.sourceCode { 
    width: 120% !important;
}

d-article pre { 
    width: 120% !important;
}

div.l-body {
    width: 120% !important;
}

div.l-body img {
    margin-right: 20% !important;
}

</style>

```{r setup, include = FALSE}
knitr::opts_chunk$set(message = F, 
                      error = F, 
                      warning = F,
                      fig.align = "center")

```

<!-- Start of the article -->

## Introduction

Bump charts are a special type of line charts that visualize the rankings of multiple objects over time. These charts are especially useful for comparing and highlighting trends. Honestly, I haven't really heard of this kind of charts before until recently I came across a [Tweet](https://mobile.twitter.com/rappa753/status/1548335653909250048/photo/1) about creating bump charts using ggplot. I then took a deeper dive into it and felt that this would certainly make an interesting topic to blog about. Also, I believe the charts will come in handy some day in the future, both for myself and for the reader like you!

So without further ado, let's jump right in!

## Prepare the data

As mentioned earlier, bump charts are useful for visualizing rankings of items over time. Instead of using a built-in R dataset, this time I'll prepare my own one, which focuses on the rankings of five ecological journals (<span style="color:#0E96D4">*Journal of Ecology*</span>, <span style="color:#7581BD">*Journal of Animal Ecology*</span>, <span style="color:#48A749">*Journal of Applied Ecology*</span>, <span style="color:#E38D26">*Functional Ecology*</span>, and <span style="color:#DE2127">*Methods in Ecology and Evolution*</span>) from the [British Ecological Society](https://www.britishecologicalsociety.org/publications/journals/). Specifically, I would like to see how the rankings of these five journals, in terms of their impact factors, change over the past decade.   

To get the data, I visited [Journal Citation Reports](https://clarivate.com/webofsciencegroup/solutions/journal-citation-reports/) website and downloaded their impact factor records. 

Let's read in the datasets and do some data wrangling:

```{r}
library(tidyverse)
library(janitor)  # for the function "row_to_names()"

# Create a list of url paths
BES_journals <- c("J_ECOL", "J_ANIM_ECOL", "J_APPL_ECOL", "FUNCT_ECOL", "METHODS_ECOL_EVOL")
dataset_urls <- str_glue("https://raw.githubusercontent.com/GenChangHSU/ggGallery/master/_posts/2022-08-01-post-18-bump-charts-with-ggplot/BES_journals_data/{BES_journals}.csv")

# Loop through the url paths
BES_journals_data <- map(dataset_urls, function(x){
  read_csv(x) %>% 
    row_to_names(row_number = 5) %>%  # set the fifth row as column names
    slice_head(n = nrow(.)-4)  # remove the last four rows
  }) %>%
  `names<-`(BES_journals) %>%
  bind_rows(.id = "Journal") %>%  # convert the list to a dataframe
  select(Journal, Year, IF = `Journal impact factor`) %>% 
  filter(Year >= 2011) %>%  # retain data starting from 2011
  group_by(Year) %>% 
  mutate(IF = as.numeric(IF),
         Ranking = row_number(desc(IF))) %>%  # add the journal rankings by year
  arrange(Year, Journal)
  
head(BES_journals_data, n = 10)
```
<br>

## Basic bump chart



```{r, fig.width = 5, fig.height = 3.5, out.width = "70%"}
library(ggtext)

col_pal <- set_names(c("#0e96d4", "#7581bd", "#48a749", "#e38d26", "#de2127"), nm = BES_journals)

ggplot(BES_journals_data) + 
  geom_line(aes(x = Year, y = Ranking, color = Journal, group = Journal), size = 2) + 
  geom_point(aes(x = Year, y = Ranking, color = Journal), shape = 21, fill = "white", size = 4, stroke = 2) +
  scale_y_reverse(position = "right") +
  scale_color_manual(values = col_pal) +
  labs(title = "<img src='https://raw.githubusercontent.com/GenChangHSU/ggGallery/master/_posts/2021-07-10-post-5-awesome-text-display-with-ggtext/IBO_logos/main.png'
    width='100' />",
       subtitle = "Journal rankings based on their impact factors each year",
       caption = "Data source: Journal Citation Reports") +
  theme_void() +
  theme(legend.position = "none",
        plot.background = element_rect(fill = , color = NA),
        plot.title = element_markdown(margin = margin(b = 3, unit = "mm"), face = "bold", size = 20, hjust = 0.5),
        plot.subtitle = element_text(margin = margin(b = 5, unit = "mm"), hjust = 0.5),
        plot.caption = element_text(margin = margin(t = 5, unit = "mm"), face = "italic", color = "grey60"),
        axis.text.x = element_text(size = 12),
        axis.text.y = element_text(size = 12))






```





## A more elaborated bump chart with smooth lines






## Ribbon bump chart







## Summary


Hope you learn something useful from this simple post and don't forget to leave your comments and suggestions below if you have any!









