---
title: "Post #20. ggplot Legend Tips Series No.7: Working on legends with theme()"
description: |
    In this post, you will learn how to modify the appearance of ggplot legends using the arguments in `theme()`.
author:
  - name: Gen-Chang Hsu
date: 2022-10-01
output:
  distill::distill_article:
    self_contained: false
categories:
  - "2022"
  - "Legend Tips Series"
preview: ../../homepage_images/Post20.png
draft: true
---

<!-- Webpage style -->
<style>
d-article a {
    color: #2780e3 !important;
    border-bottom: none !important;
}

d-article a:hover {
    color: #2780e3 !important;
    border-bottom: 2px solid !important;
}

d-byline {
    margin-left: -10% !important;
}

d-title {
    margin-left: -10%;
}

d-title h1{
    font-size: 45px;
    width: 130%;
}

d-article {
    margin-left: -10%;
}

p {
    width: 120%;
}

d-article h2 {
    width: 120%;
}

d-article h3 {
  width: 120%;
  font-size: 28px;
}

div.article-footer{
    width: 120%;
}

d-article div.sourceCode { 
    width: 120% !important;
}

d-article pre { 
    width: 120% !important;
}

div.l-body {
    width: 120% !important;
}

div.l-body img {
    margin-right: 20% !important;
}

</style>

```{r setup, include = FALSE}
knitr::opts_chunk$set(message = F, 
                      error = F, 
                      warning = F,
                      fig.align = "center")

```

<!-- Start of the article -->

## Introduction

There are three main groups of functions that work on ggplot legends: `guides()`, `scale_XX` family of functions, and `theme()`. In my previous posts, I introduced how we can modify discrete and continuous legends using the first two function groups (check theme out here! [Post #10](https://genchanghsu.github.io/ggGallery/posts/2022-01-28-post-10-ggplot-legend-tips-series-no1-working-on-discrete-scale-legends-with-guides/), [Post #11](https://genchanghsu.github.io/ggGallery/posts/2022-02-01-post-11-ggplot-legend-tips-series-no2-working-on-continuous-legends-with-guides/), [Post #16](https://genchanghsu.github.io/ggGallery/posts/2022-06-09-post-16-ggplot-legend-tips-series-no5-working-on-discrete-legends-with-scalexx-functions/), and [Post #17](https://genchanghsu.github.io/ggGallery/posts/2022-07-02-post-17-ggplot-legend-tips-series-no6-working-on-continuous-legends-with-scalexx-functions/)). In this post, I will continue to introduce to you the third function "`theme()`". I'll also wrap up this topic by comparing the three function groups and discuss their best usages. Hopefully, you will be able to make the most of these functions to achieve your ggplot goals after the journey! 


## The `theme()` function

`theme()` is one of the main components of ggplots and controls many aspects of the plot appearance: plot title, panel background, axis labels, grid lines, facet strips, and of course legends. There are a bunch of legend-related arguments, and here I classify them into four main categories: 

<span style="display: block; margin-top: 0px; margin-left: 10px"> (1) Arguments related to legend box</span>
<span style="display: block; margin-top: 5px; margin-left: 10px"> (2) Arguments related to legend keys</span>
<span style="display: block; margin-top: 5px; margin-left: 10px"> (3) Arguments related to legend title and labels</span>
<span style="display: block; margin-top: 5px; margin-left: 10px"> (4) Arguments related to legend layout</span>

Let's first create an example plot with two legends, one discrete and one continuous, using the [`CO2`](https://stat.ethz.ch/R-manual/R-devel/library/datasets/html/zCO2.html) data set:

```{r, fig.width = 6, fig.height = 4, out.width = "75%"}
library(tidyverse)

P <- ggplot(data = CO2) + 
  geom_boxplot(aes(x = Treatment, y = uptake, color = Treatment), width = 0.5) + 
  geom_point(aes(x = Treatment, y = uptake, fill = uptake), position = position_jitter(width = 0.05), shape = 21, size = 2, color = "transparent") + 
  labs(x = "Treatment", y = expression(paste(CO[2], " uptake rate"))) + 
  theme_classic(base_size = 14) + 
  scale_color_brewer(palette = "Set1") + 
  scale_fill_viridis_c(name = expression(paste(CO[2], " uptake rate")))

P
```

### (1) Legend box

The arguments related to legend box control the size and margin of entire legend area as well as individual legend boxes. The arrangement of the legends can be specified via `legend.box = `; the space between the panel area and legend area can be specified via `legend.box.spacing =`. 

```{r, fig.width = 9, fig.height = 5, out.width = "80%"}
P + theme(legend.box = "horizontal",
          legend.box.just = "right",
          legend.box.spacing = unit(0, "inch"),
          legend.box.background = element_rect(fill = "green1",
                                               color = "black",
                                               size = 1,
                                               linetype = "dashed"),
          legend.box.margin = margin(t = 10, r = 10, b = 10, l = 10),
          legend.background = element_rect(fill = "grey90",
                                           color = "black",
                                           size = 0.5,
                                           linetype = "dotted"),
          legend.margin = margin(t = 5, r = 5, b = 5, l = 5))

```
Did you notice that both legends were modified? This is an important feature of `theme()`: it changes globally everything in the plot. So if you want to change just a certain legend, you should use `guide()` and specify the specific aesthetic mapping instead.


### (2) Legend keys

```{r, fig.width = 6, fig.height = 4, out.width = "75%"}
P + theme(legend.key = element_rect(fill = "grey50",
                                    color = "black",
                                    size = 0.5,
                                    linetype = "dashed"),
          legend.key.height = unit(0.3, "inch"),
          legend.key.width = unit(0.3, "inch"))

```

### (3) Legend title and labels

```{r, fig.width = 6, fig.height = 4, out.width = "75%"}
P + theme(legend.title = element_text(face = "bold",
                                      color = "blue",
                                      size = 12,
                                      hjust = 0,
                                      angle = 30,
                                      margin = margin(l = 0)),
          legend.title.align = 1,
          legend.text = element_text(color = "red", 
                                     face = "bold"),
          legend.text.align = 0.5,
          legend.spacing.x = unit(0.5, "inch"),
          legend.spacing.y = unit(0.25, "inch"))

```


### (4) Legend layout

```{r, fig.width = 6, fig.height = 4, out.width = "75%"}
P + theme(legend.position = "top",
          legend.direction = "horizontal")



```




## Overvall comparison of the three function groups







## Summary



Hope you learn something useful from this post and don't forget to leave your comments and suggestions below if you have any!








